---
title: "R Notebook"
output:
  word_document: default
  html_notebook: default
---

## Import Necessary packages

```{r echo=TRUE, message=TRUE, warning=TRUE}
library(tidyverse)
library(lmtest)
library(caTools)
```

The dataset can be located from this github [repo](https://github.com/Rhino-byte/GroupWork/blob/main/Data/Merged_data.csv)

```{r message=TRUE, warning=TRUE}
# Import data
Merged_data <- read_csv('Cleaned_data.csv')
head(Merged_data)

```

## Data Cleaning/ Preparation
```{r}
# Check for duplicates
sum(duplicated(Merged_data))
```


```{r}
# Check missing values
pander::pander(colSums(is.na(Merged_data)))

```

For this regression model we are interested in understanding the relationship
between the worldwide gross for movie production against various variables in our models.
The Dependent variable is **Worldwide_gross**

```{r}
# Invetsigate the properties of dependent variable
ggplot(data = Merged_data,aes(x=worldwide_gross))+geom_density()+theme_classic()
# There is alot of skewness in the data (positive skewness)

# Test for normality in the data
ks.test(Merged_data$worldwide_gross,"pnorm")
# Normality test violated a glm model that uses the gamma distribution would be effective to try and model the relationship 
```

```{r}
# remove rows where the gross returns is zero
Merged_data %>% filter(!worldwide_gross <= 0) -> Merged_data
```


## GLM models
```{r}
#
Merged_data %>% select(runtime_minutes,averagerating,popularity,production_budget,domestic_gross,foreign_gross,worldwide_gross)->Model_data

# Split the data for Train and test data
Y = Model_data$worldwide_gross
sample_sl =sample.split(Y,SplitRatio = 3/4)

# Create Train and test data
train_data =subset(Model_data,sample_sl==TRUE)

test_data =subset(Model_data,sample_sl==FALSE)

# Fit GLM gamma model
Fit_model=glm(worldwide_gross~.,family = Gamma(link = "log"),data = train_data)


# Summary of the model
pander::pander(summary.glm(Fit_model))
```

### Interpreting the glm model

This generalized linear model (GLM) with a Gamma distribution and log link function is used to model the relationship between `worldwide_gross` and several predictors related to movie characteristics. Here's an interpretation of the results:

### Residuals
The deviance residuals summary provides a quick look at the spread of residuals:

- **Min, 1Q, Median, 3Q, Max** values suggest that residuals are moderately centered around zero, indicating an acceptable fit. However, some residuals have relatively large negative and positive values, implying a few observations deviate notably from the model’s predictions.

### Coefficients
Each predictor in the model has an associated estimated coefficient, its standard error, and p-value:

- **(Intercept)**: The intercept is significant, with a large positive estimate (17.78), representing the baseline log of worldwide gross when all other predictors are at zero.

- **runtime_minutes**: This variable has a negative coefficient (-0.0007785), but it is not statistically significant (p = 0.472), meaning `runtime_minutes` does not appear to have a substantial impact on worldwide gross in this model.

- **averagerating**: This has a significant negative effect (-0.0446, p = 0.027), suggesting that, holding other factors constant, higher ratings are weakly associated with lower worldwide gross, though the effect is relatively small.

- **popularity**: This variable has a positive and statistically significant coefficient (0.009753, p = 0.0005), indicating a positive association with worldwide gross—higher popularity scores are associated with higher gross earnings.

- **production_budget**: A positive and significant effect (3.83e-09, p < 0.001), implying that larger production budgets lead to higher worldwide gross, though the impact is small per unit increase in budget.

- **domestic_gross** and **foreign_gross**: Both are highly significant (p < 0.001) and positively associated with `worldwide_gross`, with each having an estimated impact proportional to their gross values, underscoring their strong, direct contributions to worldwide gross.

### Model Fit

- **Dispersion parameter**: The estimated dispersion parameter for the Gamma family is 0.399962, suggesting moderate variability around the fitted values.

- **Deviance**: The residual deviance (745.68) is much lower than the null deviance (1894.53), indicating that the model significantly reduces deviance (improves fit) compared to a null model without predictors.

- **AIC**: The Akaike Information Criterion (AIC) of 38770 can be used to compare this model with other potential models, where a lower AIC generally indicates a better fit.

### Conclusion

This model suggests that `popularity`, `production_budget`, `domestic_gross`, and `foreign_gross` are the primary predictors of `worldwide_gross`, with statistically significant positive associations. Although `averagerating` shows a significant but small negative impact, the impact of `runtime_minutes` does not appear statistically relevant in this context.























